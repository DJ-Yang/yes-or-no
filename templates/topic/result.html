{% extends 'base.html' %}

{% load static %}

{% block head_meta %}
<meta name="description" content="{{ topic.description }}" />
<meta property="og:title" content="{{ topic.title }}" />
<meta property="og:image" content="{{ topic.thumb_image.url }}" />
<meta property="og:description" content="{{ topic.description }}" />
{% endblock %}

{% block head_link %}
<link rel="stylesheet" href="{% static 'css/result.css' %}">
<link rel="stylesheet" href="{% static 'css/result_chart.css' %}">
{% endblock %}

{% block head_script %}
<script type="text/javascript">
    var postive = "{{ result.postive }}";
    var negative = "{{ result.negative }}";


    var data = "{{result}}"

    data = data.replace(/&#x27;/gi, '"');

    json_data = JSON.parse(data);

    let chart_gender_female_data = [json_data['negative_female'], json_data['positive_female']];
    let chart_gender_male_data = [json_data['negative_male'], json_data['positive_male']];
    let chart_age_postive = [json_data['positive_10age'], json_data['positive_20age'], json_data['positive_30age'], json_data['positive_40age'], json_data['positive_50age'], json_data['positive_60age']];
    let chart_age_negative = [json_data['negative_10age'], json_data['negative_20age'], json_data['negative_30age'], json_data['negative_40age'], json_data['negative_50age'], json_data['negative_60age']];
    let chart_all_female_10 = 'female-10-' + json_data['positive_10age_female'] + '-' + json_data['negative_10age_female'];
    let chart_all_female_20 = 'female-20-' + json_data['positive_20age_female'] + '-' + json_data['negative_20age_female'];
    let chart_all_female_30 = 'female-30-' + json_data['positive_30age_female'] + '-' + json_data['negative_30age_female'];
    let chart_all_female_40 = 'female-40-' + json_data['positive_40age_female'] + '-' + json_data['negative_40age_female'];
    let chart_all_female_50 = 'female-50-' + json_data['positive_50age_female'] + '-' + json_data['negative_50age_female'];
    let chart_all_female_60 = 'female-60-' + json_data['positive_60age_female'] + '-' + json_data['negative_60age_female'];
    let chart_all_male_10 = 'male-10-' + json_data['positive_10age_male'] + '-' + json_data['negative_10age_male'];
    let chart_all_male_20 = 'male-20-' + json_data['positive_20age_male'] + '-' + json_data['negative_20age_male'];
    let chart_all_male_30 = 'male-30-' + json_data['positive_30age_male'] + '-' + json_data['negative_30age_male'];
    let chart_all_male_40 = 'male-40-' + json_data['positive_40age_male'] + '-' + json_data['negative_40age_male'];
    let chart_all_male_50 = 'male-50-' + json_data['positive_50age_male'] + '-' + json_data['negative_50age_male'];
    let chart_all_male_60 = 'male-60-' + json_data['positive_60age_male'] + '-' + json_data['negative_60age_male'];

    let chart_all_female = [chart_all_female_10, chart_all_female_20, chart_all_female_30, chart_all_female_40, chart_all_female_50, chart_all_female_60];
    let chart_all_male = [chart_all_male_10, chart_all_male_20, chart_all_male_30, chart_all_male_40, chart_all_male_50, chart_all_male_60];

</script>
<script type="text/javascript">
    function share() {
        var url = encodeURI(encodeURIComponent(myform.url.value));
        var title = encodeURI(myform.title.value);
        var shareURL = "https://share.naver.com/web/shareView.nhn?url=" + url + "&title=" + title;
        window.open(shareURL);
    }
</script>


{% endblock %}

{% block content %}
<div class="topic-wrapper">
    <div class="topic-background">
        <div class="topic-thumb" style="background-image: url('/static/img/test.jpg')">
        </div>

        <div class="topic-title-box">
            <div class="topic-title">문재인 대통령에대한 나의 생각은?</div>
            <div class="topic-subtitle">2020년 5월 8일 문재인 대통령 지지율 70프로에 관한 기사가 업로드 되었을 때. 해당 게시물의 댓글에서는 지지율을 인정할 수 없다는
                의견들이 다수를 차지했습니다. 시청자 여러분이 직접 의견을
                제시해주세요!</div>

            <div class="btn-box">
                <div class="btn revoting-btn">
                    <img src="{% static 'img/checked.png' %}" width="15px">
                    다시하기
                </div>
                <div class="btn share-btn">
                    <img src="{% static 'img/share.png' %}" width="12px">
                    공유하기
                </div>
            </div>
        </div>
    </div>

    <div class="select-wrapper">
        <div class="select-box">
            <div class="total-chart-box">
                <div id="chart4"></div>
            </div>
            <div class="selection">
                <div class="selection-text selection-active">1. 1번 선택지 내용입니드아아</div>
                <div class="selection-text">2. 2번 선택지 내용입니드아아</div>
                <div class="selection-text">3. 3번 선택지 내용입니드아아</div>
                <div class="selection-text">4. 4번 선택지 내용입니드아아</div>
            </div>
        </div>
    </div>

    <div class="topic-analysis-box">
        <div>
            <div class="chart-row">
                <div class="chart-box">
                    <div id="chart2"></div>
                    <div id="chart"></div>
                </div>
                <div class="chart-box">
                    <div id="chart3"></div>
                </div> 
                <div class="chart-box">
                    <div id="chart4"></div>
                </div>
            </div>
        </div>
    </div>

    <div>

    </div>
</div>


<script src="{% static 'js/apexcharts.js' %}"></script>
<script>
    var options = {
        series: [44, 55, 13, 43],
        chart: {
            type: 'pie',
        },
        labels: ['A', 'B', 'C', 'D'],
        dataLabels: {
            enabled: true,
            textAnchor: 'start',
            formatter: function (val, opts) {
                console.log(val, opts)
                return Math.round(val) + '%';
            },
            style: {
                fontSize: '14px',
                fontFamily: 'Helvetica, Arial, sans-serif',
                fontWeight: 'regular',
            },
        },
        legend: {
            show: false
        },
        tooltip: {
            enabled: false
        }
    };

    var chart = new ApexCharts(document.querySelector("#chart4"), options);
    chart.render();
</script>
{% endblock %}



{% block extra_js %}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="{% static 'js/result.js' %}"></script>

{% endblock %}