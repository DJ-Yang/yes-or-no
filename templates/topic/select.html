{% extends 'base.html' %}

{% load static %}


{% block head_meta %}
<meta name="description" content="{{ topic.description }}" />
<meta property="og:title" content="{{ topic.title }}" />
<meta property="og:image" content="{{ topic.thumb_image.url }}" />
<meta property="og:description" content="{{ topic.description }}" />
{% endblock %}

{% block head_link %}
<link rel="stylesheet" href="{% static 'css/select.css' %}">
{% endblock %}

{% block head_script %}
{% endblock %}

{% block content %}
<div class="topic">
  <div class="topic-title">
    {{ topic.title }}
  </div>
  <div class="topic-graph-wrap">
    <div class="label-agree" style="width:{{topic.get_count_yes}};">{{topic.get_count_yes}}</div>
    <div class="label-disagree">{% if topic.get_count_no != '0%'%}{{topic.get_count_no}}{%endif%}</div>
    <div class="agree" style="width: {{topic.get_count_yes}};">
    </div>
  </div>

  <div class="explain">
    사진을 클릭한 후 버튼을 눌러주세요.
  </div>
  <div class="selection">

    <div class="selection1">
      <span class="sel1-des">{{topic.selection1_des}}</span>
      <div class="img-wrapper">
        <img id="sel1" src="{{ topic.selection1_image.url}}">
      </div>
    </div>
    <div class="vs">vs</div>
    <div class="selection2">
      <span class="sel2-des">{{topic.selection2_des}}</span>
      <div class="img-wrapper">
        <img id="sel2" src="{{ topic.selection2_image.url}}">
      </div>
    </div>
    <div id="" class="submit" onclick="clickSelection(this.id)">
      선택하기
    </div>

    <div class="_baa_"></div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/select.js' %}"></script>
<!-- selection 선택시 함수 -->
<script>
  function clickSelection(e) {

    if (e=='') 
      alert('사진을 클릭해주세요.');   
    

    let target = e;
    let selection;
    let topic_id = '{{topic.id}}'
    let type;
    let checkUserLogin = '{{ request.user }}';

    if (!(checkUserLogin === 'AnonymousUser')) {
      if (target == 'sel1') {
        selection_des = '{{topic.selection1_des}}';
        type = 0;
      } else if (target == 'sel2') {
        selection_des = '{{topic.selection2_des}}';
        type = 1;
      } else {
        selection_des = 'error';
      }
      if (selection_des != 'error' || !selection_des) {
        selectType(selection_des, topic_id, type)
      }
    } else {
      alert('로그인이 필요한 작업입니다.');
      location.href = '/auth/signin/';
    }
  }
</script>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script type="text/javascript" src="{% static 'js/topic.js' %}?4"></script>
{% endblock %}